% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parametric-engine.R
\name{.parametric_engine}
\alias{.parametric_engine}
\title{Internal parametric HRF fitting engine}
\usage{
.parametric_engine(
  Y_proj,
  S_target_proj,
  hrf_eval_times,
  hrf_interface,
  theta_seed,
  theta_bounds,
  lambda_ridge = 0.01,
  verbose = FALSE
)
}
\arguments{
\item{Y_proj}{Numeric matrix of projected BOLD data (timepoints x voxels)}

\item{S_target_proj}{Numeric matrix of projected stimulus design (timepoints x regressors)}

\item{hrf_eval_times}{Numeric vector of time points for HRF evaluation}

\item{hrf_interface}{List with HRF function interface}

\item{theta_seed}{Numeric vector of starting parameters}

\item{theta_bounds}{List with elements \code{lower} and \code{upper}}

\item{lambda_ridge}{Numeric ridge penalty (default: 0.01)}

\item{verbose}{Logical whether to print progress (default: FALSE)}
}
\value{
List with elements:
\itemize{
\item \code{theta_hat}: Matrix of parameter estimates (voxels x parameters)
\item \code{beta0}: Numeric vector of amplitudes
\item \code{r_squared}: Numeric vector of R-squared values
\item \code{residuals}: Matrix of residuals (timepoints x voxels)
\item \code{coeffs}: Matrix of linear coefficients
}
}
\description{
Core implementation of the Taylor approximation method for parametric HRF estimation.
This is the main workhorse function that performs voxel-wise parameter estimation.
}
\note{This engine assumes evenly spaced scan times (constant TR). If acquisition times vary, adjust the stimulus design or interpolate the data before calling this function.}
\keyword{internal}
