% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gauss-newton-refinement.R
\name{.gauss_newton_refinement}
\alias{.gauss_newton_refinement}
\title{Gauss-Newton refinement for hard voxels}
\usage{
.gauss_newton_refinement(
  theta_hat_voxel,
  r2_voxel,
  Y_proj,
  S_target_proj,
  scan_times,
  hrf_eval_times,
  hrf_interface,
  theta_bounds,
  queue_labels,
  max_iter_gn = 5,
  tol_gn = 1e-04,
  lambda_ridge = 0.01,
  step_size = 1,
  verbose = FALSE
)
}
\arguments{
\item{theta_hat_voxel}{Matrix of current parameter estimates (voxels x parameters)}

\item{r2_voxel}{Numeric vector of current R-squared values}

\item{Y_proj}{Numeric matrix of projected BOLD data (timepoints x voxels)}

\item{S_target_proj}{Numeric matrix of projected stimulus design}

\item{scan_times}{Numeric vector of scan acquisition times}

\item{hrf_eval_times}{Numeric vector of HRF evaluation time points}

\item{hrf_interface}{List with HRF interface functions}

\item{theta_bounds}{List with elements \code{lower} and \code{upper}}

\item{queue_labels}{Character vector of refinement queue assignments}

\item{max_iter_gn}{Maximum iterations for Gauss-Newton}

\item{tol_gn}{Convergence tolerance}

\item{lambda_ridge}{Ridge penalty}

\item{step_size}{Initial step size for line search}

\item{verbose}{Logical whether to print progress}
}
\value{
List with updated estimates and convergence information
}
\description{
Implements full nonlinear Gauss-Newton optimization for the most challenging
voxels that don't respond well to Taylor approximation methods. This is the
most computationally intensive refinement but can recover good fits for
difficult cases.
}
\keyword{internal}
