% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/local-recentering.R
\name{.local_recentering_moderate}
\alias{.local_recentering_moderate}
\title{Local voxel-specific re-centering for moderate difficulty voxels}
\usage{
.local_recentering_moderate(
  theta_hat_voxel,
  r2_voxel,
  Y_proj,
  S_target_proj,
  scan_times,
  hrf_eval_times,
  hrf_interface,
  theta_bounds,
  queue_labels,
  coeffs_voxel,
  lambda_ridge = 0.01,
  epsilon_beta = 1e-06,
  verbose = FALSE
)
}
\arguments{
\item{theta_hat_voxel}{Matrix of current parameter estimates (voxels x parameters)}

\item{r2_voxel}{Numeric vector of current R-squared values}

\item{Y_proj}{Numeric matrix of projected BOLD data (timepoints x voxels)}

\item{S_target_proj}{Numeric matrix of projected stimulus design}

\item{scan_times}{Numeric vector of scan acquisition times}

\item{hrf_eval_times}{Numeric vector of HRF evaluation time points}

\item{hrf_interface}{List with HRF interface functions}

\item{theta_bounds}{List with elements \code{lower} and \code{upper}}

\item{queue_labels}{Character vector of refinement queue assignments}

\item{coeffs_voxel}{Matrix of current linear coefficients}

\item{lambda_ridge}{Ridge penalty for refitting}

\item{epsilon_beta}{Small value to avoid division by zero}

\item{verbose}{Logical whether to print progress}
}
\value{
List with updated estimates and refinement statistics
}
\description{
Performs local re-centering using each voxel's current estimate as its own
expansion point. This is more computationally intensive than global or K-means
re-centering but can improve fits for voxels that don't fit well with any
global or cluster-based expansion point.
}
\keyword{internal}
